/* Following is both tables above joined together, so we know the supply and demand for each skill. */

-- select demand_sq.'Skill Name', demand_sq.'Skill Demand', supply_sq.'Supply of Skill'
-- from 
-- (	
-- 	select s.'Skill Name' as 'Skill Name', count(s.'Skill Name') as 'Skill Demand'
-- 	from 'Demand' d, 'Clients-Skills' cs, 'Skills' s
-- 	where d.'Client-Skill ID' = cs.'Client-Skill ID'
-- 	and cs.'Skill ID' = s.'Skill ID'
-- 	group by s.'Skill Name'
-- ) as demand_sq,
-- (
-- 	select s.'Skill Name', count(cs.'Skill ID') as 'Supply of Skill'
-- 	from 'Clients-Skills' cs, 'Clients' c, 'Skills' s
-- 	where cs.'Client ID' = c.'Client ID'
-- 	and s.'Skill ID' = cs.'Skill ID'
-- 	group by s.'Skill Name'
-- ) as supply_sq
-- where demand_sq.'Skill Name' = supply_sq.'Skill Name'

/* Everything from Client Skills, Clients, Demand, and Skills. */

-- select distinct *
-- from 'Clients-Skills' cs, 'Clients' c, 'Demand' d, 'Skills' s
-- where cs.'Client ID' = c.'Client ID'
-- and d.'Client-Skill ID' = cs.'Client-Skill ID'
-- and s.'Skill ID' = cs.'Skill ID'

/* Client name, skill name, and priority. */

-- select distinct c.'Client Name', s.'Skill Name', s.'Priority'
-- from 'Clients-Skills' cs, 'Clients' c, 'Demand' d, 'Skills' s
-- where cs.'Client ID' = c.'Client ID'
-- and d.'Client-Skill ID' = cs.'Client-Skill ID'
-- and s.'Skill ID' = cs.'Skill ID'

/* Count of demand for each skill. */

-- select s.'Skill Name', count(s.'Skill Name') as 'Demand for Skill' 
-- from 'Clients-Skills' cs, 'Clients' c, 'Demand' d, 'Skills' s
-- where cs.'Client ID' = c.'Client ID'
-- and d.'Client-Skill ID' = cs.'Client-Skill ID'
-- and s.'Skill ID' = cs.'Skill ID'
-- group by s.'Skill Name'

/* Count of supply of each skill. */

-- select s.'Skill Name', count(cs.'Skill ID') as 'Supply of Skill'
-- from 'Clients-Skills' cs, 'Clients' c, 'Demand' d, 'Skills' s
-- where cs.'Client ID' = c.'Client ID'
-- and d.'Client-Skill ID' = cs.'Client-Skill ID'
-- and s.'Skill ID' = cs.'Skill ID'
-- group by s.'Skill Name'

-- select *
-- from 
-- 	(select s.'Skill Name' as sn, count(s.'Skill Name') as 'Demand for Skill' 
-- 	from 'Clients-Skills' cs, 'Clients' c, 'Demand' d, 'Skills' s
-- 	where cs.'Client ID' = c.'Client ID'
-- 	and d.'Client-Skill ID' = cs.'Client-Skill ID'
-- 	and s.'Skill ID' = cs.'Skill ID'
-- 	group by s.'Skill Name') as demand_sq,
-- 	(select s.'Skill Name' as sn, count(cs.'Skill ID') as 'Supply of Skill'
-- 	from 'Clients-Skills' cs, 'Clients' c, 'Demand' d, 'Skills' s
-- 	where cs.'Client ID' = c.'Client ID'
-- 	and d.'Client-Skill ID' = cs.'Client-Skill ID'
-- 	and s.'Skill ID' = cs.'Skill ID'
-- 	group by s.'Skill Name') as supply_sq
-- where
-- 	demand_sq.sn = supply_sq.sn

-- select s.'Skill Name' as sn, count(cs.'Skill ID') as 'Supply of Skill'
-- from 'Clients-Skills' cs, 'Clients' c, 'Demand' d, 'Skills' s
-- where cs.'Client ID' = c.'Client ID'
-- and d.'Client-Skill ID' = cs.'Client-Skill ID'
-- and s.'Skill ID' = cs.'Skill ID'
-- group by s.'Skill Name'

/* Following is count of demand for each skill. */

-- select s.'Skill Name' as 'Skill Name', count(s.'Skill Name') as 'Skill Demand'
-- from 'Demand' d, 'Clients-Skills' cs, 'Skills' s
-- where d.'Client-Skill ID' = cs.'Client-Skill ID'
-- and cs.'Skill ID' = s.'Skill ID'
-- group by s.'Skill Name'

/* Following is count of supply of each skill. */

-- select s.'Skill Name', count(cs.'Skill ID') as 'Supply of Skill'
-- from 'Clients-Skills' cs, 'Clients' c, 'Skills' s
-- where cs.'Client ID' = c.'Client ID'
-- and s.'Skill ID' = cs.'Skill ID'
-- group by s.'Skill Name'

/* Following is both tables above joined together, so we know the supply and demand for each skill. */

select demand_sq.'Skill Name', demand_sq.'Skill Demand', supply_sq.'Supply of Skill'
from 
(	
	select s.'Skill Name' as 'Skill Name', count(s.'Skill Name') as 'Skill Demand'
	from 'Demand' d, 'Clients-Skills' cs, 'Skills' s
	where d.'Client-Skill ID' = cs.'Client-Skill ID'
	and cs.'Skill ID' = s.'Skill ID'
	group by s.'Skill Name'
) as demand_sq,
(
	select s.'Skill Name', count(cs.'Skill ID') as 'Supply of Skill'
	from 'Clients-Skills' cs, 'Clients' c, 'Skills' s
	where cs.'Client ID' = c.'Client ID'
	and s.'Skill ID' = cs.'Skill ID'
	group by s.'Skill Name'
) as supply_sq
where demand_sq.'Skill Name' = supply_sq.'Skill Name'

/* Sagar's query */

-- select s.'Skill Name', cs.'Skill ID' as skilldemand, app.'Skill ID' as skillsupply
-- from Skills s, 'Clients-Skills' cs, Applicants app
-- where s.'Skill ID' = cs.'Skill ID'
-- and s.'Skill ID' = app.'Skill ID'
-- -- group by cs.'Skill ID', app.'Skill ID'
